dataObjectMapping:
  name: m_200_MIDAS_INSTITUTION_VW_SAT_INSTITUTION
  extensions:
    - schemaName: AzP-DV
      properties:
        targetType: Satellite
  source:
    dataStore:
      connectionKey: HSTG
    dataObject:
      objectSchema: dbo
      objectName: HSTG_MIDAS_INSTITUTION_VW
  targetDataItem:
    dataStore:
      connectionKey: INT
    dataObject:
      objectSchema: dbo
      objectName: SAT_INSTITUTION
  mappings:
    - sourceDataItem:
        columnName: INSTITUTION_SK
        dataItemType: calculation
        language: T-SQL
        code: |
          CONVERT(CHAR(32), HASHBYTES('MD5',
                                  ISNULL(RTRIM(CONVERT(NVARCHAR(100), [INSTITUTION_ID])), 'NA') + '|'
                                  ), 2)
      targetDataItem:
        columnName: INSTITUTION_SK
    - sourceDataItem:
        columnName: OMD_EFFECTIVE_DATETIME
      targetDataItem:
        columnName: OMD_EFFECTIVE_DATETIME
    - sourceDataItem:
        columnName: INSTITUTION_NAME
      targetDataItem:
        columnName: INSTITUTION_NAME
    - sourceDataItem:
        columnName: RATING
      targetDataItem:
        columnName: RATING
    - sourceDataItem:
        columnName: SEARCH_NAME
      targetDataItem:
        columnName: SEARCH_NAME
    - sourceDataItem:
        columnName: STATUS
      targetDataItem:
        columnName: STATUS
