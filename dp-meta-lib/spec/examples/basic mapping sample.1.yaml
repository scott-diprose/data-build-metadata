objectMapping:
  name: m_200_MIDAS_INSTITUTION_VW_SAT_INSTITUTION
  extensions:
    - schemaName: AzP-DV
      properties:
        targetType: Satellite
  source:
    dataStore:
      connectionKey: HSTG
      connectionDescription: EDW History Staging Area
      connectionString: Provider=odbc,etc.
    dataObject:
      objectSchema: dbo
      objectName: HSTG_MIDAS_INSTITUTION_VW
  target:
    dataStore:
      connectionKey: INT
      connectionDescription: EDW Integration Area
      connectionString: Provider=odbc,etc.
    dataObject:
      objectSchema: dbo
      objectName: SAT_INSTITUTION
  mappings:
    - source:
        columnName: INSTITUTION_SK
        dataItemType: calculation
        language: T-SQL
        code: |
          CONVERT(CHAR(32), HASHBYTES('MD5',
                                  ISNULL(RTRIM(CONVERT(NVARCHAR(100), [INSTITUTION_ID])), 'NA') + '|'
                                  ), 2)
      target:
        columnName: INSTITUTION_SK
    - source:
        columnName: OMD_EFFECTIVE_DATETIME
      target:
        columnName: OMD_EFFECTIVE_DATETIME
    - source:
        columnName: INSTITUTION_NAME
      target:
        columnName: INSTITUTION_NAME
    - source:
        columnName: RATING
      target:
        columnName: RATING
    - source:
        columnName: SEARCH_NAME
      target:
        columnName: SEARCH_NAME
    - source:
        columnName: STATUS
      target:
        columnName: STATUS
